!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/forms","@angular/common"],e):e(t["thf-calendar"]={},t.core,t.forms,t.common)}(this,function(t,e,a,n){"use strict";var r=["pt","en","es"],o=function(){function t(t,a){this.thfDate=t,this.thfCalendarLangService=a,this.dayVisible=!1,this.displayMonths=Array(),this.displayWeekDays=Array(),this.monthVisible=!1,this.yearVisible=!1,this.onTouched=null,this.propagateChange=null,this.today=new Date,this.change=new e.EventEmitter}return Object.defineProperty(t.prototype,"locale",{get:function(){return this._locale},set:function(t){this._locale=r.includes(t)?t:"pt",this.initializeLanguage()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxDate",{get:function(){return this._maxDate},set:function(t){this._maxDate=this.thfDate.getDateForDateRange(t,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minDate",{get:function(){return this._minDate},set:function(t){this._minDate=this.thfDate.getDateForDateRange(t,!0)},enumerable:!0,configurable:!0}),t.prototype.initializeLanguage=function(){this.thfCalendarLangService.setLanguage(this.locale),this.displayWeekDays=this.thfCalendarLangService.getWeekDaysArray(),this.displayMonths=this.thfCalendarLangService.getMonthsArray(),this.displayMonth=this.displayMonths[this.displayMonthNumber]},t.propDecorators={locale:[{type:e.Input,args:["t-locale"]}],maxDate:[{type:e.Input,args:["t-max-date"]}],minDate:[{type:e.Input,args:["t-min-date"]}],change:[{type:e.Output,args:["t-change"]}]},t}(),i=function(){function t(){this.language="pt",this.months=[{pt:"Janeiro",en:"January",es:"Enero"},{pt:"Fevereiro",en:"February",es:"Febrero"},{pt:"Março",en:"March",es:"Marzo"},{pt:"Abril",en:"April",es:"Abril"},{pt:"Maio",en:"May",es:"Mayo"},{pt:"Junho",en:"June",es:"Junio"},{pt:"Julho",en:"July",es:"Julio"},{pt:"Agosto",en:"August",es:"Agosto"},{pt:"Setembro",en:"September",es:"Setiembre"},{pt:"Outubro",en:"October",es:"Octubre"},{pt:"Novembro",en:"November",es:"Noviembre"},{pt:"Dezembro",en:"December",es:"Diciembre"}],this.shortWeekDays=[{pt:"Dom",en:"Sun",es:"Dom"},{pt:"Seg",en:"Mon",es:"Lun"},{pt:"Ter",en:"Tue",es:"Mar"},{pt:"Qua",en:"Wed",es:"Mié"},{pt:"Qui",en:"Thu",es:"Jue"},{pt:"Sex",en:"Fri",es:"Vie"},{pt:"Sáb",en:"Sat",es:"Sáb"}],this.monthLabel={pt:"Mês",en:"Month",es:"Mes"},this.yearLabel={pt:"Ano",en:"Year",es:"Año"}}return t.prototype.getMonth=function(t){return this.months[t][this.language]},t.prototype.getMonthLabel=function(){return this.monthLabel[this.language]},t.prototype.getMonthsArray=function(){for(var t=Array(),e=0;e<this.months.length;e++)t.push(this.months[e][this.language]);return t},t.prototype.getWeekDays=function(t){return this.shortWeekDays[t][this.language]},t.prototype.getWeekDaysArray=function(){for(var t=Array(),e=0;e<this.shortWeekDays.length;e++)t.push(this.shortWeekDays[e][this.language]);return t},t.prototype.getYearLabel=function(){return this.yearLabel[this.language]},t.prototype.setLanguage=function(t){t&&t.length>=2&&(t=t.toLowerCase().slice(0,2),this.language="pt"===t||"en"===t||"es"===t?t:"pt")},t.decorators=[{type:e.Injectable}],t}(),s=function(){function t(){}return t.prototype.monthDates=function(t,e,a,n){if(void 0===a&&(a=null),void 0===n&&(n=null),"number"!=typeof e||e<0||e>11)throw Error("month must be a number (Jan is 0)");var r=[],o=[],i=0,s=new Date(t,e,1);t>=0&&t<100&&s.setFullYear(t),s=this.weekStartDate(s);do{for(i=0;i<7;i++)o.push(a?a(s):s),(s=new Date(s.getTime())).setDate(s.getDate()+1);r.push(n?n(o):o),o=[]}while(s.getMonth()<=e&&s.getFullYear()===t);return r},t.prototype.monthDays=function(t,e){return this.monthDates(t,e,function(t){return t.getMonth()===e?t:0})},t.prototype.weekStartDate=function(t){for(var e=new Date(t.getTime());0!==e.getDay();)e.setDate(e.getDate()-1);return e},t.decorators=[{type:e.Injectable}],t}();var l,h=function(){function t(){this.dateRegex=new RegExp("^(?:[0-9])\\d{1}(?:[0-9])\\d{1}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\\d|3[01])$"),this.isoRegex=new RegExp("^(?:[0-9])\\d{1}(?:[0-9])\\d{1}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\\d|3[01])T(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d(?:Z|-0[1-9]|-1\\d|-2[0-3]|-00:?(?:0[1-9]|[0-5]\\d)|\\+[01]\\d|\\+2[0-3])(?:|:?[0-5]\\d)$")}return t.prototype.convertIsoToDate=function(t,e,a){if(t){var n=this.getDateFromIso(t),r=n.year,o=n.month,i=n.day;if(e){var s=new Date(r,o-1,i,0,0,0);return this.setYearFrom0To100(s,r),s}if(a){s=new Date(r,o-1,i,23,59,59);return this.setYearFrom0To100(s,r),s}var l=Date.parse(t),h=6e4*(new Date).getTimezoneOffset();return new Date(l+h)}},t.prototype.convertDateToISO=function(t){if(t){var e=t.getFullYear(),a=t.getMonth()+1,n=t.getDate()<10?"0"+t.getDate():t.getDate(),r=a<10?"0"+a:a;return this.formatYear(e)+"-"+r+"-"+n}return null},t.prototype.formatYear=function(t){return t>999?t.toString():t>99&&t<1e3?"0"+t:t>9&&t<100?"00"+t:t>=0&&t<10?"000"+t:void 0},t.prototype.getDateFromIso=function(t){var e=parseInt(t.substring(8,10),10),a=parseInt(t.substring(5,7),10);return{year:parseInt(t.substring(0,4),10),month:a,day:e}},t.prototype.getDateForDateRange=function(t,e){var a=e?[0,0,0]:[23,59,59];if(t instanceof Date){var n=this.splitDate(t),r=n.year,o=n.month,i=n.day,s=new(Date.bind.apply(Date,[void 0,r,o,i].concat(a)));return this.setYearFrom0To100(s,r),s}if(this.isValidIso(t))return this.convertIsoToDate(t,e,!e)},t.prototype.isDateRangeValid=function(t,e){void 0===t&&(t=""),void 0===e&&(e="");for(var a=t.split("-").map(function(t){return parseInt(t,10)}),n=e.split("-").map(function(t){return parseInt(t,10)}),r=0;r<=a.length;r++){if(a[r]>n[r])return!0;if(a[r]<n[r])return!1}return!0},t.prototype.isValidIso=function(t){return this.dateRegex.test(t)||this.isoRegex.test(t)},t.prototype.setYearFrom0To100=function(t,e){e>=0&&e<100&&t.setFullYear(e)},t.prototype.sortDate=function(t,e,a){return function(t,e,a){if(void 0===a&&(a=!0),a){if(t<e)return-1;if(t>e)return 1}else if(!1===a){if(t<e)return 1;if(t>e)return-1}return 0}(this.validateDate(t),this.validateDate(e),a)},t.prototype.splitDate=function(t){return{year:t.getFullYear(),month:t.getMonth(),day:t.getDate()}},t.prototype.validateDateRange=function(t,e,a){return e&&a?t>=e&&t<=a:e&&!a?t>=e:!(!e&&a)||t<=a},t.prototype.validateDate=function(t){var e=t instanceof Date?this.convertDateToISO(t):t;return this.isValidIso(e)?e:void 0},t.decorators=[{type:e.Injectable}],t}(),c=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),d=function(t){function n(e,a,n){var r=t.call(this,n,a)||this;return r.thfCalendarService=e,r}return c(n,t),n.prototype.ngOnInit=function(){this.init()},n.prototype.getBackgroundColor=function(t,e){return t===e?"thf-calendar-box-background-selected":"thf-calendar-box-background"},n.prototype.getDayBackgroundColor=function(t){return this.getDayColor(t,"background")},n.prototype.getDayForegroundColor=function(t){return this.getDayColor(t,"foreground")},n.prototype.getForegroundColor=function(t,e){return t===e?"thf-calendar-box-foreground-selected":"thf-calendar-box-foreground"},n.prototype.getMonthLabel=function(){return this.thfCalendarLangService.getMonthLabel()},n.prototype.getYearLabel=function(){return this.thfCalendarLangService.getYearLabel()},n.prototype.onNextMonth=function(){this.displayMonthNumber<11?this.updateDisplay(this.displayYear,this.displayMonthNumber+1):this.updateDisplay(this.displayYear+1,0)},n.prototype.onPreviousMonth=function(){this.displayMonthNumber>0?this.updateDisplay(this.displayYear,this.displayMonthNumber-1):this.updateDisplay(this.displayYear-1,11)},n.prototype.onSelectDate=function(t){this.date=t,this.dateIso=this.thfDate.convertDateToISO(t),this.propagateChange&&this.propagateChange(this.dateIso),this.change.emit(this.dateIso)},n.prototype.onSelectMonth=function(t,e){this.selectDay(),this.updateDisplay(t,e)},n.prototype.onSelectYear=function(t,e){"month"===this.lastDisplay?this.selectMonth():this.selectDay(),this.currentYear=t,this.updateDisplay(t,e)},n.prototype.registerOnChange=function(t){this.propagateChange=t},n.prototype.registerOnTouched=function(t){this.onTouched=t},n.prototype.registerOnValidatorChange=function(t){this.validatorChange=t},n.prototype.selectDay=function(){this.dayVisible=!0,this.monthVisible=!1,this.yearVisible=!1,this.lastDisplay="day"},n.prototype.selectMonth=function(){this.dayVisible=!1,this.monthVisible=!0,this.yearVisible=!1,this.lastDisplay="month"},n.prototype.selectYear=function(){this.dayVisible=!1,this.monthVisible=!1,this.yearVisible=!0},n.prototype.updateYear=function(t){this.updateDisplay(this.displayYear+t,this.displayMonthNumber)},n.prototype.validateModel=function(t){this.validatorChange&&this.validatorChange(t)},n.prototype.validate=function(t){return null},n.prototype.writeValue=function(t){t?this.writeDate(t):(this.date=void 0,this.updateDate(this.today))},n.prototype.addAllYearsInDecade=function(t){var e;for(e=t;e<t+10;e++)this.displayDecade.push(e)},n.prototype.equalsDate=function(t,e){try{return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}catch(t){return!1}},n.prototype.getDecadeArray=function(t){if(this.displayDecade=Array(),t%10!=0)for(;t%10!=0;)t--;this.updateDecade(t)},n.prototype.getColorForDate=function(t,e){return this.thfDate.validateDateRange(t,this.minDate,this.maxDate)?"thf-calendar-box-"+e+"-selected":"thf-calendar-box-"+e+"-selected-disabled"},n.prototype.getColorForDateRange=function(t,e){return this.thfDate.validateDateRange(t,this.minDate,this.maxDate)?"thf-calendar-box-"+e:"thf-calendar-box-"+e+"-disabled"},n.prototype.getColorForToday=function(t,e){return this.thfDate.validateDateRange(t,this.minDate,this.maxDate)?"thf-calendar-box-"+e+"-today":"thf-calendar-box-"+e+"-today-disabled"},n.prototype.getDayColor=function(t,e){return this.equalsDate(t,this.date)?this.getColorForDate(t,e):this.equalsDate(t,this.today)?this.getColorForToday(t,e):this.getColorForDateRange(t,e)},n.prototype.init=function(){this.date&&this.thfDate.isValidIso(this.thfDate.convertDateToISO(this.date))?this.updateDate(this.date):this.updateDate(this.today),this.initializeLanguage(),this.selectDay()},n.prototype.selectDateFromDate=function(t){this.date=t,this.onSelectDate(this.date)},n.prototype.selectDateFromIso=function(t){var e=this.thfDate.getDateFromIso(t),a=e.year,n=e.month,r=e.day,o=new Date(a,n-1,r);this.thfDate.setYearFrom0To100(o,a),this.date=o,this.onSelectDate(this.date)},n.prototype.updateDate=function(t){t&&(this.currentMonthNumber=t.getMonth(),this.currentYear=t.getFullYear(),this.updateDisplay(this.currentYear,this.currentMonthNumber))},n.prototype.updateDecade=function(t){this.addAllYearsInDecade(t),this.displayStartDecade=t,this.displayFinalDecade=t+9},n.prototype.updateDisplay=function(t,e){var a=this.thfCalendarService.monthDays(t,e);this.displayDays=[].concat.apply([],a),this.displayMonthNumber=e,this.displayMonth=this.displayMonths[e],this.displayYear=t,this.getDecadeArray(t)},n.prototype.writeDate=function(t){t instanceof Date?this.selectDateFromDate(t):this.writeDateIso(t),this.updateDate(this.date)},n.prototype.writeDateIso=function(t){this.thfDate.isValidIso(t)?this.selectDateFromIso(t):this.date=void 0},n.decorators=[{type:e.Component,args:[{selector:"thf-calendar",template:'<div class="thf-calendar"> <div *ngIf="dayVisible"> <div class="thf-calendar-nav"> <span class="thf-calendar-nav-left thf-icon thf-icon-arrow-left" (click)="onPreviousMonth()"></span> <div class="thf-calendar-nav-title" attr-calendar> <span class="thf-clickable thf-mr-1" (click)="selectMonth()">{{ displayMonth }}</span> <span class="thf-clickable" (click)="selectYear()">{{ displayYear }}</span> </div> <span class="thf-calendar-nav-right thf-icon thf-icon-arrow-right" (click)="onNextMonth()"></span> </div> <div class="thf-calendar-content"> <div class="thf-calendar-labels"> <div class="thf-calendar-label" *ngFor="let day of displayWeekDays"> {{ day.toLowerCase() }} </div> </div> <div class="thf-calendar-content-list-day"> <div *ngFor="let day of displayDays" class="thf-calendar-day" [ngClass]="getDayBackgroundColor(day)" (click)="onSelectDate(day)"> <span *ngIf="day != 0" [ngClass]="getDayForegroundColor(day)"> {{ day.getDate() }} </span> </div> </div> </div> </div> <div *ngIf="monthVisible"> <div class="thf-calendar-nav"> <span class="thf-calendar-nav-left thf-icon thf-icon-arrow-left" (click)="updateYear(-1)"></span> <div class="thf-calendar-nav-title" attr-calendar> <span class="thf-clickable" (click)="selectYear()">{{ displayYear }}</span> </div> <span class="thf-calendar-nav-right thf-icon thf-icon-arrow-right" (click)="updateYear(1)"></span> </div> <div class="thf-calendar-content"> <div class="thf-calendar-labels"> <div class="thf-calendar-label"> {{ getMonthLabel() }} </div> </div> <div class="thf-calendar-content-list-month"> <div *ngFor="let month of displayMonths; let i = index;" class="thf-calendar-month" [ngClass]="getBackgroundColor(i, displayMonthNumber)" (click)="onSelectMonth(displayYear, i)" attr-calendar> <span [ngClass]="getForegroundColor(i, displayMonthNumber)"> {{ month }} </span> </div> </div> </div> </div> <div *ngIf="yearVisible"> <div class="thf-calendar-nav"> <span class="thf-calendar-nav-left thf-icon thf-icon-arrow-left" (click)="updateYear(-10)"></span> <div class="thf-calendar-nav-title"> {{ displayStartDecade }} - {{ displayFinalDecade }} </div> <span class="thf-calendar-nav-right thf-icon thf-icon-arrow-right" (click)="updateYear(10)"></span> </div> <div class="thf-calendar-content"> <div class="thf-calendar-labels"> <div class="thf-calendar-label"> {{ getYearLabel() }} </div> </div> <div class="thf-calendar-content-list-year"> <div *ngFor="let year of displayDecade; let i = index;" class="thf-calendar-year" [ngClass]="getBackgroundColor(year, currentYear)" (click)="onSelectYear(year, displayMonthNumber)"attr-calendar> <span [ngClass]="getForegroundColor(year, currentYear)"> {{ year }} </span> </div> </div> </div> </div> </div> ',providers:[s,i,{provide:a.NG_VALUE_ACCESSOR,useExisting:e.forwardRef(function(){return n}),multi:!0},{provide:a.NG_VALIDATORS,useExisting:e.forwardRef(function(){return n}),multi:!0}]}]}],n.ctorParameters=function(){return[{type:s},{type:i},{type:h}]},n}(o),p=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[n.CommonModule],declarations:[d],exports:[d],providers:[i,s]}]}],t}();t.ThfCalendarComponent=d,t.ThfCalendarModule=p,Object.defineProperty(t,"__esModule",{value:!0})});