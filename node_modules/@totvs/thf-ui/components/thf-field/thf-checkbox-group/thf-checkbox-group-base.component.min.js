import{EventEmitter,Input,Output}from"@angular/core";import{convertToBoolean,convertToInt}from"./../../../utils/util";import{requiredFailed}from"../validators";var thfCheckboxGroupColumnsDefaultLength=6,thfCheckboxGroupColumnsTotalLength=12,ThfCheckboxGroupBaseComponent=function(){function e(){this.checkedOptions={},this.checkedOptionsList=[],this.mdColumns=thfCheckboxGroupColumnsDefaultLength,this._columns=thfCheckboxGroupColumnsDefaultLength,this._disabled=!1,this._indeterminate=!1,this._required=!1,this.ngModelChange=new EventEmitter,this.change=new EventEmitter}return Object.defineProperty(e.prototype,"columns",{get:function(){return this._columns},set:function(e){var t=convertToInt(e,thfCheckboxGroupColumnsDefaultLength);this._columns=this.getGridSystemColumns(t,4),this.mdColumns=this.getGridSystemColumns(t,2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled=convertToBoolean(e),this.validateModel(this.checkIndeterminate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indeterminate",{get:function(){return this._indeterminate},set:function(e){this._indeterminate=convertToBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},set:function(e){this._options=Array.isArray(e)?e:[],this.removeDuplicatedOptions()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"required",{get:function(){return this._required},set:function(e){this._required=convertToBoolean(e),this.validateModel(this.checkIndeterminate())},enumerable:!0,configurable:!0}),e.prototype.changeValue=function(){var e=this.checkIndeterminate();this.propagateChange?this.propagateChange(e):this.ngModelChange.emit(e),this.change.emit(e)},e.prototype.checkIndeterminate=function(){return this.indeterminate?this.checkedOptions:this.checkedOptionsList},e.prototype.checkOption=function(e){this._disabled||e.disabled||(this.checkOptionModel(e),this.changeValue())},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(e){},e.prototype.writeValue=function(e){e&&this.checkedOptions!==e?this.generateCheckOptions(e):(this.checkedOptionsList=[],this.checkedOptions={})},e.prototype.registerOnValidatorChange=function(e){this.validatorChange=e},e.prototype.validate=function(e){if(!this.indeterminate&&requiredFailed(this.required,this.disabled,e.value)||this.isInvalidIndeterminate())return{required:{valid:!1}}},e.prototype.validateModel=function(e){this.validatorChange&&this.validatorChange(e)},e.prototype.checkColumnsRange=function(e,t){return e>=1&&e<=t},e.prototype.checkOptionModel=function(e){this.checkedOptions[e.value]=!this.checkedOptions[e.value],!this.indeterminate&&this.checkedOptionsList.includes(e.value)?this.checkedOptionsList.splice(this.checkedOptionsList.indexOf(e.value),1):this.indeterminate||this.checkedOptionsList.push(e.value)},e.prototype.generateCheckOptions=function(e){var t=this;this.checkedOptions={},e instanceof Array?(this.checkedOptionsList=e,this.options.forEach(function(n){t.checkedOptions[n.value]=e.includes(n.value)})):this.options.forEach(function(n){e[n.value]=void 0!==e[n.value]&&e[n.value],t.checkedOptions=e})},e.prototype.getGridSystemColumns=function(e,t){var n=thfCheckboxGroupColumnsTotalLength/e;return this.checkColumnsRange(e,t)?n:thfCheckboxGroupColumnsDefaultLength},e.prototype.isInvalidIndeterminate=function(){return!!(this.indeterminate&&this.required&&this.checkedOptions)&&Object.values(this.checkedOptions).every(function(e){return!1===e})},e.prototype.removeDuplicatedOptions=function(){var e=this;this.options.forEach(function(t,n){e.options.findIndex(function(e){return e.value===t.value})===n||e.options.splice(e.options.indexOf(t),1)})},e.propDecorators={name:[{type:Input,args:["name"]}],columns:[{type:Input,args:["t-columns"]}],disabled:[{type:Input,args:["t-disabled"]}],help:[{type:Input,args:["t-help"]}],indeterminate:[{type:Input,args:["t-indeterminate"]}],label:[{type:Input,args:["t-label"]}],options:[{type:Input,args:["t-options"]}],required:[{type:Input,args:["t-required"]}],ngModelChange:[{type:Output,args:["ngModelChange"]}],change:[{type:Output,args:["t-change"]}]},e}();export{ThfCheckboxGroupBaseComponent};