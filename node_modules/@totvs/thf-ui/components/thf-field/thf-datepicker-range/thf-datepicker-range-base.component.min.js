var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,a=1,r=arguments.length;a<r;a++)for(var n in e=arguments[a])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};import{EventEmitter,Input,Output}from"@angular/core";import{browserLanguage,convertToBoolean,thfLocaleDefault}from"./../../../utils/util";import{requiredFailed}from"../validators";export var thfDatepickerRangeLiteralsDefault={en:{invalidFormat:"Date in invalid format",startDateGreaterThanEndDate:"Start date greater than end date"},es:{invalidFormat:"Fecha en formato no válido",startDateGreaterThanEndDate:"Fecha de inicio mayor que fecha final"},pt:{invalidFormat:"Data no formato inválido",startDateGreaterThanEndDate:"Data inicial maior que data final"}};var ThfDatepickerRangeBaseComponent=function(){function t(t){this.thfDateService=t,this.errorMessage="",this._clean=!1,this._readonly=!1,this._required=!1,this.dateRange={start:"",end:""},this.format="dd/mm/yyyy",this.isDateRangeInputFormatValid=!0,this.isStartDateRangeInputValid=!0,this.onChange=new EventEmitter}return Object.defineProperty(t.prototype,"isDateRangeInputValid",{get:function(){return this.isDateRangeInputFormatValid&&this.isStartDateRangeInputValid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clean",{get:function(){return this._clean},set:function(t){this._clean=convertToBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=convertToBoolean(t),this.validateModel(this.dateRange)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endDate",{get:function(){return this._endDate},set:function(t){this._endDate=this.convertPatternDateFormat(t),this.dateRange.end=this.endDate,this.updateScreenByModel(this.dateRange),this.updateModel(this.dateRange)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"literals",{get:function(){return this._literals||thfDatepickerRangeLiteralsDefault[browserLanguage()]},set:function(t){t instanceof Object&&!(t instanceof Array)?this._literals=__assign({},thfDatepickerRangeLiteralsDefault[thfLocaleDefault],thfDatepickerRangeLiteralsDefault[browserLanguage()],t):this._literals=thfDatepickerRangeLiteralsDefault[browserLanguage()]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readonly",{get:function(){return this._readonly},set:function(t){this._readonly=convertToBoolean(t),this.validateModel(this.dateRange)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"required",{get:function(){return this._required},set:function(t){this._required=convertToBoolean(t),this.validateModel(this.dateRange)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startDate",{get:function(){return this._startDate},set:function(t){this._startDate=this.convertPatternDateFormat(t),this.dateRange.start=this.startDate,this.updateScreenByModel(this.dateRange),this.updateModel(this.dateRange)},enumerable:!0,configurable:!0}),t.prototype.registerOnChange=function(t){this.onChangeModel=t},t.prototype.registerOnTouched=function(t){this.onTouchedModel=t},t.prototype.registerOnValidatorChange=function(t){this.validatorChange=t},t.prototype.validate=function(t){var e=t.value||{},a=e.start?this.convertPatternDateFormat(e.start):"",r=e.end?this.convertPatternDateFormat(e.end):"";return this.requiredDateRangeFailed(a,r)?(this.errorMessage="",{required:{valid:!1}}):this.dateRangeObjectFailed(t.value)||this.dateRangeFormatFailed(a,r)?(this.errorMessage=this.literals.invalidFormat,{date:{valid:!1}}):this.dateRangeFailed(a,r)?(this.errorMessage=this.literals.startDateGreaterThanEndDate,{date:{valid:!1}}):null},t.prototype.writeValue=function(t){this.resetDateRangeInputValidation(),t&&!this.dateRangeObjectFailed(t)||(this.dateRange={start:"",end:""}),t||this.validateModel(this.dateRange),this.dateRangeObjectFailed(t)&&this.updateModel(t),this.isDateRangeObject(t)&&(this.dateRange={start:this.convertPatternDateFormat(t.start),end:this.convertPatternDateFormat(t.end)},this.updateModel(this.dateRange)),this.updateScreenByModel(this.dateRange)},t.prototype.dateFormatFailed=function(t){return t&&!this.thfDateService.isValidIso(t)},t.prototype.updateModel=function(t){var e="object"==typeof t?__assign({},t):t;this.onChangeModel&&this.onChangeModel(e)},t.prototype.validateModel=function(t){var e=__assign({},t);this.validatorChange&&this.validatorChange(e)},t.prototype.convertPatternDateFormat=function(t){return t instanceof Date?this.thfDateService.convertDateToISO(t):t},t.prototype.dateRangeFailed=function(t,e){return!this.thfDateService.isDateRangeValid(e,t)||!this.isStartDateRangeInputValid},t.prototype.dateRangeFormatFailed=function(t,e){return this.dateFormatFailed(e)||this.dateFormatFailed(t)||!this.isDateRangeInputFormatValid},t.prototype.dateRangeObjectFailed=function(t){return t&&!this.isDateRangeObject(t)},t.prototype.isDateRangeObject=function(t){return t&&t.hasOwnProperty("start")&&t.hasOwnProperty("end")},t.prototype.requiredDateRangeFailed=function(t,e){return this.isDateRangeInputValid&&requiredFailed(this.required,this.disabled,t)&&requiredFailed(this.required,this.disabled,e)},t.propDecorators={clean:[{type:Input,args:["t-clean"]}],disabled:[{type:Input,args:["t-disabled"]}],endDate:[{type:Input,args:["t-end-date"]}],help:[{type:Input,args:["t-help"]}],label:[{type:Input,args:["t-label"]}],literals:[{type:Input,args:["t-literals"]}],readonly:[{type:Input,args:["t-readonly"]}],required:[{type:Input,args:["t-required"]}],startDate:[{type:Input,args:["t-start-date"]}],onChange:[{type:Output,args:["t-change"]}]},t}();export{ThfDatepickerRangeBaseComponent};