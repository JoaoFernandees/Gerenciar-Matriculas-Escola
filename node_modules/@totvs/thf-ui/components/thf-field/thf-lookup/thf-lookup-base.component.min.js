import{EventEmitter,Input,Output}from"@angular/core";import{convertToBoolean}from"../../../utils/util";import{requiredFailed}from"../validators";var ThfLookupBaseComponent=function(){function e(){this._disabled=!1,this._focus=!1,this._required=!1,this.oldValue="",this.onChangePropagate=null,this.onTouched=null,this.placeholder="",this.onError=new EventEmitter,this.selected=new EventEmitter}return Object.defineProperty(e.prototype,"required",{get:function(){return this._required},set:function(e){this._required=convertToBoolean(e),this.validateModel(this.valueToModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focus",{get:function(){return this._focus},set:function(e){this._focus=""===e||convertToBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled=""===e||convertToBoolean(e)},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.getSubscription&&this.getSubscription.unsubscribe()},e.prototype.ngOnInit=function(){this.initializeColumn()},e.prototype.initializeColumn=function(){this.fieldLabel?this.keysDescription=[this.fieldLabel]:(this.keysDescription=[],this.keysDescription=this.columns.filter(function(e){return e.fieldLabel}).map(function(e){return e.column}))},e.prototype.registerOnValidatorChange=function(e){this.validatorChange=e},e.prototype.registerOnChange=function(e){this.onChangePropagate=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.selectValue=function(e){this.valueToModel=e[this.fieldValue],this.callOnChange(this.valueToModel),this.selected.emit(e)},e.prototype.callOnChange=function(e){this.onChangePropagate&&this.onChangePropagate(e)},e.prototype.searchById=function(e){var t=this;"string"==typeof e&&(e=e.trim()),""!==e?this.getSubscription=this.service.getObjectByValue(e,this.filterParams).subscribe(function(e){e?(t.oldValue=e[t.fieldLabel],t.selectValue(e),t.setViewValue(t.getFormattedLabel(e),e)):t.cleanModel()},function(e){t.cleanModel(),t.onError.emit(e)}):this.cleanModel()},e.prototype.validate=function(e){if(requiredFailed(this.required,this.disabled,e.value))return{required:{valid:!1}}},e.prototype.writeValue=function(e){e&&e instanceof Object?(this.oldValue=e[this.fieldLabel],this.valueToModel=e[this.fieldValue],this.setViewValue(this.getFormattedLabel(e),e)):e?this.searchById(e):this.cleanViewValue()},e.prototype.cleanModel=function(){this.cleanViewValue(),this.callOnChange(void 0)},e.prototype.cleanViewValue=function(){this.setViewValue("",{}),this.oldValue="",this.valueToModel=null},e.prototype.getFormattedLabel=function(e){return e?this.keysDescription.map(function(t){return e[t]}).join(" - "):""},e.prototype.selectModel=function(e){this.writeValue(e),e&&e instanceof Object&&this.selectValue(e)},e.prototype.validateModel=function(e){this.validatorChange&&this.validatorChange(e)},e.propDecorators={label:[{type:Input,args:["t-label"]}],literals:[{type:Input,args:["t-literals"]}],help:[{type:Input,args:["t-help"]}],placeholder:[{type:Input,args:["t-placeholder"]}],name:[{type:Input,args:["name"]}],title:[{type:Input,args:["t-title"]}],fieldValue:[{type:Input,args:["t-field-value"]}],fieldLabel:[{type:Input,args:["t-field-label"]}],filterParams:[{type:Input,args:["t-filter-params"]}],fieldFormat:[{type:Input,args:["t-field-format"]}],columns:[{type:Input,args:["t-columns"]}],service:[{type:Input,args:["t-filter-service"]}],required:[{type:Input,args:["t-required"]}],focus:[{type:Input,args:["t-focus"]}],disabled:[{type:Input,args:["t-disabled"]}],onError:[{type:Output,args:["t-error"]}],selected:[{type:Output,args:["t-selected"]}]},e}();export{ThfLookupBaseComponent};