var __extends=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();import{Component,ElementRef,ViewChild}from"@angular/core";import{v4 as uuid}from"uuid";import{ThfModalBaseComponent}from"./thf-modal-base.component";import{ThfModalService}from"./thf-modal-service";var ThfModalComponent=function(t){function e(e){var o=t.call(this)||this;return o.thfModalService=e,o.focusableElements="input, select, textarea, button:not([disabled]), a",o.id=uuid(),o}return __extends(e,t),e.prototype.close=function(e){void 0===e&&(e=!1),this.thfModalService.modalActive=void 0,t.prototype.close.call(this,e),document.removeEventListener("focus",this.focusFunction,!0),this.sourceElement&&this.sourceElement.focus()},e.prototype.closeModalOnEscapeKey=function(t){this.hideClose||(t.preventDefault(),t.stopPropagation(),this.close())},e.prototype.getPrimaryActionButtonType=function(){return this.primaryAction.danger?"danger":"primary"},e.prototype.getSecondaryActionButtonType=function(){return this.secondaryAction&&this.secondaryAction.danger&&!this.primaryAction.danger?"danger":"default"},e.prototype.onClickOut=function(t){this.clickOut&&!this.modalContent.nativeElement.contains(t.target)&&this.close()},e.prototype.open=function(){this.sourceElement=document.activeElement,t.prototype.open.call(this),this.handleFocus()},e.prototype.handleFocus=function(){var t=this;this.thfModalService.modalActive=this.id,setTimeout(function(){t.modalContent&&(t.initFocus(),document.addEventListener("focus",t.focusFunction,!0))})},e.prototype.initFocus=function(){var t=this;(this.focusFunction=function(e){t.thfModalService.modalActive=t.thfModalService.modalActive||t.id,t.modalContent.nativeElement.contains(e.target)||t.thfModalService.modalActive!==t.id||(e.stopPropagation(),t.firstElement.focus())},this.setFirstElement(),this.hideClose)?this.firstElement.focus():(this.modalContent.nativeElement.querySelectorAll(this.focusableElements)[1]||this.modalContent.nativeElement).focus()},e.prototype.setFirstElement=function(){this.firstElement=this.modalContent.nativeElement.querySelector(this.focusableElements)||this.modalContent.nativeElement},e.decorators=[{type:Component,args:[{selector:"thf-modal",template:'<div *ngIf="!isHidden" class="thf-modal" tabindex="0" (keydown.esc)="closeModalOnEscapeKey($event)"> <div class="thf-modal-overlay"> <div class="thf-modal-container thf-pb-2 thf-pt-2" (click)="onClickOut($event)"> <div class="thf-modal-vertical-align"> <div #modalContent class="thf-modal-content thf-modal-{{ size }}" tabindex="-1"> <div class="thf-modal-header"> <div class="thf-modal-title"> <a *ngIf="!hideClose" class="thf-modal-header-close-button" tabindex="0" (click)="close(true)"> <span class="thf-icon thf-icon-close"></span> </a> {{ title }} </div> </div> <div class="thf-modal-body"> <ng-content></ng-content> </div> <div class="thf-modal-footer"> <thf-button *ngIf="secondaryAction" [t-disabled]="secondaryAction.disabled" [t-label]="secondaryAction.label" [t-loading]="secondaryAction.loading" [t-type]="getSecondaryActionButtonType()" (t-click)="secondaryAction.action()"> </thf-button> <thf-button class="thf-button-modal-first-action" [t-disabled]="primaryAction.disabled" [t-label]="primaryAction.label" [t-loading]="primaryAction.loading" [t-type]="getPrimaryActionButtonType()" (t-click)="primaryAction.action()"> </thf-button> </div> </div> </div> </div> </div> </div> '}]}],e.ctorParameters=function(){return[{type:ThfModalService}]},e.propDecorators={modalContent:[{type:ViewChild,args:["modalContent",{read:ElementRef}]}]},e}(ThfModalBaseComponent);export{ThfModalComponent};