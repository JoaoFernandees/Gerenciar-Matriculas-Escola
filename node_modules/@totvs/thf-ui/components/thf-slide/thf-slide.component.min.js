var __extends=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();import{Component,ContentChild,ElementRef,HostListener,QueryList,ViewChild,ViewChildren}from"@angular/core";import{animate,AnimationBuilder,keyframes,style}from"@angular/animations";import{ThfSlideBaseComponent}from"./thf-slide-base.component";import{ThfSlideContentTemplateDirective}from"./directives/thf-slide-content-template.directive";import{ThfSlideItemComponent}from"./thf-slide-item/thf-slide-item.component";var thfSlideDefaultHeight=336,thfSlideIntervalMin=1e3,thfSlideMinHeight=192,thfSlideTiming="250ms ease",ThfSlideComponent=function(t){function e(e){var i=t.call(this)||this;return i.builder=e,i.isLoaded=!1,i.currentSlideIndex=0,i.slideItems=[],i}return __extends(e,t),Object.defineProperty(e.prototype,"hasElements",{get:function(){return!!this.slide.nativeElement.offsetWidth&&!!this.itemsElements&&!!this.itemsElements.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isImageSlide",{get:function(){return!this.slideContentTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){return this.currentSlideIndex*this.slideItemWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasSlides",{get:function(){return!!this.slides&&!!this.slides.length},enumerable:!0,configurable:!0}),e.prototype.onResize=function(){this.slide&&(this.setSlideItemWidth(),this.goToItem(this.currentSlideIndex))},e.prototype.ngDoCheck=function(){!this.isLoaded&&this.hasElements&&(this.setSlideItemWidth(),this.isLoaded=!0,this.hasSlides&&this.startSlide())},e.prototype.goToItem=function(t){this.interval>thfSlideIntervalMin&&this.startInterval(),this.currentSlideIndex=t,this.animate(this.offset)},e.prototype.nextControl=function(){this.interval>thfSlideIntervalMin&&this.startInterval(),this.next()},e.prototype.next=function(){if(this.currentSlideIndex+1===this.slideItems.length)return this.currentSlideIndex=0,void this.animate(0);this.currentSlideIndex=(this.currentSlideIndex+1)%this.slideItems.length,this.animate(this.offset)},e.prototype.previous=function(){if(0===this.currentSlideIndex)return this.currentSlideIndex=this.slideItems.length-1,void this.animate(this.offset);this.currentSlideIndex=(this.currentSlideIndex-1+this.slideItems.length)%this.slideItems.length,this.animate(this.offset)},e.prototype.previousControl=function(){this.interval>thfSlideIntervalMin&&this.startInterval(),this.previous()},e.prototype.setSlideHeight=function(t){this.setHeight(t)},e.prototype.animate=function(t){if(this.hasElements){var e=this.buildTransitionAnimation(t);this.player=e.create(this.slide.nativeElement),this.player.play()}},e.prototype.buildTransitionAnimation=function(t){return this.builder.build([animate(thfSlideTiming,keyframes([style({transform:"translateX(-"+t+"px)"})]))])},e.prototype.createArrayForTemplate=function(t){this.slideItems=t.slice()},e.prototype.createArrayFromSlides=function(t){var e=this;t.every(function(t){return"string"==typeof t})?t.forEach(function(t){return e.slideItems.push({image:""+t})}):this.slideItems=t.slice()},e.prototype.setDefaultHeight=function(t){t&&t<=thfSlideMinHeight||!t&&this.isImageSlide?(this.slide.nativeElement.style.height=thfSlideDefaultHeight+"px",this.imageHeight=thfSlideDefaultHeight):this.imageHeight=void 0},e.prototype.setHeight=function(t){t&&t>thfSlideMinHeight?(this.slide.nativeElement.style.height=t+"px",this.imageHeight=t):this.setDefaultHeight(t)},e.prototype.setSlideItemWidth=function(){this.hasElements&&(this.slideItemWidth=this.itemsElements.first.itemElement.nativeElement.getBoundingClientRect().width)},e.prototype.cancelInterval=function(){clearInterval(this.setInterval)},e.prototype.setSlideItems=function(t){this.hasSlides?this.slideContentTemplate?this.createArrayForTemplate(t):this.createArrayFromSlides(t):(this.slideItems=[],this.cancelInterval())},e.prototype.startSlide=function(){this.setSlideHeight(this.height),this.interval>thfSlideIntervalMin&&this.startInterval(),this.currentSlideIndex=0},e.prototype.startInterval=function(){var t=this;this.setInterval&&this.cancelInterval(),this.setInterval=this.hasSlides&&this.hasElements?setInterval(function(){t.next()},this.interval):void 0},e.decorators=[{type:Component,args:[{selector:"thf-slide",template:'<div class="thf-slide-wrapper"> <div class="thf-slide-outer"> <div class="thf-slide-inner" #slide> <ng-container *ngFor="let item of slideItems; let index = index;"> <thf-slide-item [t-action]="item.action" [t-data]="item" [t-image]="item.image" [t-image-height]="imageHeight" [t-template]="slideContentTemplate" [t-alt]="item.alt" [t-link]="item.link"> </thf-slide-item> </ng-container> </div> <thf-slide-control *ngIf="hasSlides && slides.length > 1"  t-control="previous" (t-click)="previousControl()"> </thf-slide-control> <thf-slide-control *ngIf="hasSlides && slides.length > 1" t-control="next" (t-click)="nextControl()"> </thf-slide-control> </div> <thf-slide-circles *ngIf="hasSlides && slides.length > 1" [t-current-slide-index]="currentSlideIndex" [t-items]="slideItems" (t-click)="goToItem($event)"> </thf-slide-circles> </div> '}]}],e.ctorParameters=function(){return[{type:AnimationBuilder}]},e.propDecorators={slideContentTemplate:[{type:ContentChild,args:[ThfSlideContentTemplateDirective]}],slide:[{type:ViewChild,args:["slide"]}],itemsElements:[{type:ViewChildren,args:[ThfSlideItemComponent]}],onResize:[{type:HostListener,args:["window:resize"]}]},e}(ThfSlideBaseComponent);export{ThfSlideComponent};